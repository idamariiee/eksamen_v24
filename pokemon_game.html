<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./game.css">
    <title>Pokemon Game!</title>

</head>

<body>

    <div class="main-container">
        <!-- Healthbar for pokemons -->
        <div class="hero-health-containers">
            <!-- Charmanders health bar -->
            <div class="healthbar-container">
                <div class="healthbar charmander-health"></div>
                <div class="text-container">
                    <p id="charmander-name-txt">Charmander</p>
                    <div class="text-container charmander-health-txt"></div>
                </div>
            </div>
            <!-- Pikachus health bar -->
            <div class="healthbar-container">
                <div class="healthbar pikachu-health"></div>
                <div class="text-container">
                    <p id="pikachu-name-txt">Pikachu</p>
                    <div class="text-container pikachu-health-txt"></div>
                </div>
            </div>
            <!-- Bulbasaur health bar -->
            <div class="healthbar-container">
                <div class="healthbar bulbasaur-health"></div>
                <div class="text-container">
                    <p id="bulbasaur-name-txt">Bulbasaur</p>
                    <div class="text-container bulbasaur-health-txt"></div>
                </div>
            </div>
        </div>
        <div class="enemy-health-container">
            <div class="healthbar-container">
                <div class="healthbar enemy-health"></div>
                <div class="text-container">
                    <p id="enemy-name-txt">Mewtwo</p>
                    <div class="text-container enemy-health-txt"></div>
                </div>
            </div>
        </div>
        <div class="img-container charmander">
            <img class="hero" src="" alt="Charmander" />
        </div>
        <div class="img-container pikachu">
            <img class="hero" src="" alt="Pikachu" />
        </div>
        <div class="img-container bulbasaur">
            <img class="hero" src="" alt="bulbasaur" />
        </div>
        <div class="enemy-container">
            <div class="img-container mewtwo-container">
            </div>
        </div>
    </div>

    <script>

        let pokemonArray = [];
        let mewtwoObject = {};

        fetch("https://pokeapi.co/api/v2/pokemon/charmander/")
            .then((res) => res.json())
            .then((data) => {
                pokemonArray.push({
                    name: data.name,
                    maxHP: data.stats[0].base_stat,
                    currentHP: data.stats[0].base_stat,
                    damage: 100,
                    alive: true,
                    id: 0
                });

                document.querySelector(".charmander img").src = data.sprites.front_default;

                const charmanderHealth = data.stats[0].base_stat;
                document.querySelector(".charmander-health-txt").textContent = `${charmanderHealth} / ${charmanderHealth} HP`;

                const charmanderHealthBar = document.querySelector(".charmander-health");
                charmanderHealthBar.style.width = `${(charmanderHealth / pokemonArray[0].maxHP) * 100}%`;
            });

        fetch("https://pokeapi.co/api/v2/pokemon/pikachu/")
            .then((res) => res.json())
            .then((data) => {
                pokemonArray.push({
                    name: data.name,
                    maxHP: data.stats[0].base_stat,
                    currentHP: data.stats[0].base_stat,
                    damage: 400,
                    alive: true,
                    id: 1
                });

                document.querySelector(".pikachu img").src = data.sprites.front_default;

                const pikachuHealth = data.stats[0].base_stat;
                document.querySelector(".pikachu-health-txt").textContent = `${pikachuHealth} / ${pikachuHealth} HP`;

                const pikachuHealthBar = document.querySelector(".pikachu-health");
                pikachuHealthBar.style.width = `${(pikachuHealth / pokemonArray[1].maxHP) * 100}%`;
            });

        fetch("https://pokeapi.co/api/v2/pokemon/bulbasaur/")
            .then((res) => res.json())
            .then((data) => {
                pokemonArray.push({
                    name: data.name,
                    maxHP: data.stats[5].base_stat,
                    currentHP: data.stats[5].base_stat,
                    damage: 400,
                    alive: true,
                    id: 2
                });

                document.querySelector(".bulbasaur img").src = data.sprites.front_default;

                const bulbasaurHealth = data.stats[5].base_stat;
                document.querySelector(".bulbasaur-health-txt").textContent = `${bulbasaurHealth} / ${bulbasaurHealth} HP`;

                const bulbasaurHealthBar = document.querySelector(".bulbasaur-health");
                bulbasaurHealthBar.style.width = `${(bulbasaurHealth / pokemonArray[2].maxHP) * 100}%`;
            });

        // Fetch Mewtwos data 
        fetch("https://pokeapi.co/api/v2/pokemon/mewtwo/")
            .then((res) => res.json())
            .then((data) => {
                mewtwoObject = {
                    maxHP: data.stats[0].base_stat,
                    currentHP: data.stats[0].base_stat,
                    damage: 200,
                    alive: true,
                };
                document.querySelector(".mewtwo-container").innerHTML = `<img class="mewtwo" src="${data.sprites.front_default}" alt="Mewtwo" />`;

                const mewtwoHealth = data.stats[0].base_stat;
                document.querySelector(".enemy-health-txt").textContent = `${mewtwoHealth} / ${mewtwoHealth} HP`;

                const mewtwoHealthBar = document.querySelector(".enemy-health");
                mewtwoHealthBar.style.width = `${(mewtwoHealth / 100) * 100}%`;
            })
            .catch((error) => console.log("Error fetching Mewtwo's data:", error));

        // Attack funksjon
        function attackMewtwo(hero) {
            console.log(`${hero.name} attacks Mewtwo!`);
        }

        // Event listeners for klikk
        document.querySelector(".img-container.charmander").addEventListener("click", function () {
            attackMewtwo(pokemonArray[0]);
        });

        document.querySelector(".img-container.pikachu").addEventListener("click", function () {
            attackMewtwo(pokemonArray[1]);
        });

        document.querySelector(".img-container.bulbasaur").addEventListener("click", function () {
            attackMewtwo(pokemonArray[2]);
        });

    </script>
</body>

</html>